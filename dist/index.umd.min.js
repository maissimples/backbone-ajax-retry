/*!
 * backbone-retry-requests v0.0.0
 * (c) Vitor Luiz Cavalcanti
 * Released under the MIT License.
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("jquery")):"function"==typeof define&&define.amd?define(["exports","jquery"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).BackboneRetryRequests={},e.$)}(this,(function(e,t){"use strict";function r(e=100){return t=>t*e}const s=[408,429];function n(e){return s.includes(e.status)||e.status>=500&&e.status<=599}function o(e){return{get:e,enumerable:!0,configurable:!0}}class a{static asProxy(e){const{context:t,onAbort:r,onError:s}=e,n=Object.assign(t.jqXHR.catch(s),{abort:r,getAllResponseHeaders:()=>{var e;return null!==(e=t.jqXHR.getAllResponseHeaders())&&void 0!==e?e:""},getResponseHeader:e=>{var r;return null!==(r=t.jqXHR.getResponseHeader(e))&&void 0!==r?r:null},overrideMimeType:e=>{t.jqXHR.overrideMimeType(e)},setRequestHeader:(e,r)=>{t.jqXHR.setRequestHeader(e,r)},statusCode:e=>{t.jqXHR.statusCode(e)}});return Object.defineProperties(n,{readyState:o((()=>t.jqXHR.readyState)),responseText:o((()=>t.jqXHR.responseText)),responseXML:o((()=>t.jqXHR.responseXML)),responseJSON:o((()=>t.jqXHR.responseJSON)),status:o((()=>t.jqXHR.status)),statusText:o((()=>t.jqXHR.statusText))}),n}static asAborted(e){const r=t.Deferred(),s=r.promise({status:0,statusText:"abort",abort:t.noop,statusCode:t.noop,getResponseHeader:()=>null,getAllResponseHeaders:()=>"",readyState:0,responseText:"",overrideMimeType:t.noop,setRequestHeader:t.noop});return r.rejectWith(e,[s,"abort","abort"]),s}}e.hasRetryableStatus=n,e.linearDelay=r,e.setupBackboneAjaxRetry=function(e,t){var s,o,i;e.retry={delay:null!==(s=null==t?void 0:t.delay)&&void 0!==s?s:r(200),retries:null!==(o=null==t?void 0:t.retries)&&void 0!==o?o:3,condition:null!==(i=null==t?void 0:t.condition)&&void 0!==i?i:n},e.$.ajaxPrefilter((e=>{var t;null!==(t=e.tries)&&void 0!==t||(e.tries=1)})),e.ajax=function(e){const t=e.ajax;return function(r={}){const s={jqXHR:t.call(e,r),settings:r};function n(e){if(!s.delay)return void s.jqXHR.abort(e);const{deferred:t,timeoutId:r}=s.delay;delete s.delay,clearTimeout(r),t.rejectWith(s.settings,[a.asAborted(s.settings),"abort","abort"])}return a.asProxy({context:s,onError:function r(o,i,u){const d=this.tries,l=d>e.retry.retries||!e.retry.condition(o,this.backboneSyncMethod),c=e.$.Deferred();if(l)return c.rejectWith(this,[o,i,u]);const y=setTimeout((()=>{delete s.delay,s.jqXHR=t.call(e,this),c.resolve(a.asProxy({context:s,onAbort:n,onError:r}))}),e.retry.delay(d,o));return s.settings=this,s.delay={deferred:c,timeoutId:y},this.tries=d+1,c},onAbort:n})}}(e),e.sync=function(e){const t=e.sync;return function(e,r,s={}){return t.call(this,e,r,Object.assign(Object.assign({},s),{backboneSyncMethod:e}))}}(e)}}));
//# sourceMappingURL=index.umd.min.js.map
