/*! backbone-ajax-retry v1.1.0 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("jquery")):"function"==typeof define&&define.amd?define(["exports","jquery"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).BackboneAjaxRetry={},e.$)}(this,(function(e,t){"use strict";function o(e=100){return t=>t*e}const r=[408,429];function n(e){return r.includes(e.status)||e.status>=500&&e.status<=599}function s(e){return{get:e,enumerable:!0,configurable:!0}}class i{static asProxy(e){const{context:t,onAbort:o,onError:r}=e,n=Object.assign(t.jqXHR.catch(r),{abort:o,getAllResponseHeaders:()=>{var e;return null!==(e=t.jqXHR.getAllResponseHeaders())&&void 0!==e?e:""},getResponseHeader:e=>{var o;return null!==(o=t.jqXHR.getResponseHeader(e))&&void 0!==o?o:null},overrideMimeType:e=>{t.jqXHR.overrideMimeType(e)},setRequestHeader:(e,o)=>{t.jqXHR.setRequestHeader(e,o)},statusCode:e=>{t.jqXHR.statusCode(e)}});return Object.defineProperties(n,{readyState:s((()=>t.jqXHR.readyState)),responseText:s((()=>t.jqXHR.responseText)),responseXML:s((()=>t.jqXHR.responseXML)),responseJSON:s((()=>t.jqXHR.responseJSON)),status:s((()=>t.jqXHR.status)),statusText:s((()=>t.jqXHR.statusText))}),n}static asAborted(e){const o=t.Deferred(),r=o.promise({status:0,statusText:"abort",abort:t.noop,statusCode:t.noop,getResponseHeader:()=>null,getAllResponseHeaders:()=>"",readyState:0,responseText:"",overrideMimeType:t.noop,setRequestHeader:t.noop});return o.rejectWith(e,[r,"abort","abort"]),r}}e.hasRetryableStatus=n,e.linearDelay=o,e.setupBackboneAjaxRetry=function(e,t){var r,s,a;e.retry={delay:null!==(r=null==t?void 0:t.delay)&&void 0!==r?r:o(200),retries:null!==(s=null==t?void 0:t.retries)&&void 0!==s?s:3,condition:null!==(a=null==t?void 0:t.condition)&&void 0!==a?a:n},e.$.ajaxPrefilter((e=>{var t;null!==(t=e.tries)&&void 0!==t||(e.tries=1)})),e.ajax=function(e){const t=e.ajax;return function(o={}){const r={jqXHR:t.call(e,o),settings:o};function n(e){if(!r.delay)return void r.jqXHR.abort(e);const{deferred:t,timeoutId:o}=r.delay;delete r.delay,clearTimeout(o),t.rejectWith(r.settings,[i.asAborted(r.settings),"abort","abort"])}return i.asProxy({context:r,onError:function o(s,a,d){var l,u,c,b,y,v,f,j,p;const R=this.tries,H=null!==(u=null===(l=this.backbone)||void 0===l?void 0:l.model.retries)&&void 0!==u?u:e.retry.retries,h=!(null===(b=null===(c=this.backbone)||void 0===c?void 0:c.model)||void 0===b?void 0:b.retryOnCreate),q="create"===(null===(v=null===(y=this.backbone)||void 0===y?void 0:y.sync)||void 0===v?void 0:v.method),x=R>H||h&&q||!e.retry.condition(s,null===(f=this.backbone)||void 0===f?void 0:f.model,null===(p=null===(j=this.backbone)||void 0===j?void 0:j.sync)||void 0===p?void 0:p.method),m=e.$.Deferred();if(x)return m.rejectWith(this,[s,a,d]);const g=setTimeout((()=>{delete r.delay,r.jqXHR=t.call(e,this),m.resolve(i.asProxy({context:r,onAbort:n,onError:o}))}),e.retry.delay(R,s));return r.settings=this,r.delay={deferred:m,timeoutId:g},this.tries=R+1,m},onAbort:n})}}(e),e.sync=function(e){const t=e.sync;return function(e,o,r={}){return t.call(this,e,o,Object.assign(Object.assign({},r),{backbone:{model:o,sync:{method:e}}}))}}(e)}}));
//# sourceMappingURL=index.umd.min.js.map
