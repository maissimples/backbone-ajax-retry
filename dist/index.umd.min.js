/*! backbone-ajax-retry v1.2.0 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("jquery")):"function"==typeof define&&define.amd?define(["exports","jquery"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).BackboneAjaxRetry={},e.$)}(this,(function(e,t){"use strict";function r(e=100){return t=>t*e}const o=[408,429];function s(e){return o.includes(e.status)||e.status>=500&&e.status<=599}function n(e){return{get:e,enumerable:!0,configurable:!0}}class i{static asProxy(e){const{context:t,onAbort:r,onError:o}=e,s=Object.assign(t.jqXHR.catch(o),{abort:r,getAllResponseHeaders:()=>{var e;return null!==(e=t.jqXHR.getAllResponseHeaders())&&void 0!==e?e:""},getResponseHeader:e=>{var r;return null!==(r=t.jqXHR.getResponseHeader(e))&&void 0!==r?r:null},overrideMimeType:e=>{t.jqXHR.overrideMimeType(e)},setRequestHeader:(e,r)=>{t.jqXHR.setRequestHeader(e,r)},statusCode:e=>{t.jqXHR.statusCode(e)}});return Object.defineProperties(s,{readyState:n((()=>t.jqXHR.readyState)),responseText:n((()=>t.jqXHR.responseText)),responseXML:n((()=>t.jqXHR.responseXML)),responseJSON:n((()=>t.jqXHR.responseJSON)),status:n((()=>t.jqXHR.status)),statusText:n((()=>t.jqXHR.statusText))}),s}static asAborted(e){const r=t.Deferred(),o=r.promise({status:0,statusText:"abort",abort:t.noop,statusCode:t.noop,getResponseHeader:()=>null,getAllResponseHeaders:()=>"",readyState:0,responseText:"",overrideMimeType:t.noop,setRequestHeader:t.noop});return r.rejectWith(e,[o,"abort","abort"]),o}}e.hasRetryableStatus=s,e.linearDelay=r,e.setupBackboneAjaxRetry=function(e,t){var o,n,a;e.retry={delay:null!==(o=null==t?void 0:t.delay)&&void 0!==o?o:r(200),retries:null!==(n=null==t?void 0:t.retries)&&void 0!==n?n:3,condition:null!==(a=null==t?void 0:t.condition)&&void 0!==a?a:s},e.$.ajaxPrefilter((e=>{var t;null!==(t=e.tries)&&void 0!==t||(e.tries=1)})),e.ajax=function(e){const t=e.ajax;return(r={})=>{const o={jqXHR:t.call(e,r),settings:r};function s(e){if(!o.delay)return void o.jqXHR.abort(e);const{deferred:t,timeoutId:r}=o.delay;delete o.delay,clearTimeout(r),t.rejectWith(o.settings,[i.asAborted(o.settings),"abort","abort"])}return i.asProxy({context:o,onError:function n(a,d,l){var u,c,y,v,b,f,j,p;const R=this.tries,H=null!==(u=r.retries)&&void 0!==u?u:e.retry.retries,h=!(null===(y=null===(c=this.backbone)||void 0===c?void 0:c.model)||void 0===y?void 0:y.retryOnCreate),q="create"===(null===(b=null===(v=this.backbone)||void 0===v?void 0:v.sync)||void 0===b?void 0:b.method),x=R>H||h&&q||!e.retry.condition(a,null===(f=this.backbone)||void 0===f?void 0:f.model,null===(p=null===(j=this.backbone)||void 0===j?void 0:j.sync)||void 0===p?void 0:p.method),g=e.$.Deferred();if(x)return g.rejectWith(this,[a,d,l]);const m=setTimeout((()=>{delete o.delay,o.jqXHR=t.call(e,this),g.resolve(i.asProxy({context:o,onAbort:s,onError:n}))}),e.retry.delay(R,a));return o.settings=this,o.delay={deferred:g,timeoutId:m},this.tries=R+1,g},onAbort:s})}}(e),e.sync=function(e){const t=e.sync;return function(e,r,o={}){var s;return t.call(this,e,r,Object.assign(Object.assign({},o),{retries:null!==(s=o.retries)&&void 0!==s?s:r.retries,backbone:{model:r,sync:{method:e}}}))}}(e)}}));
//# sourceMappingURL=index.umd.min.js.map
